#
# Fail2ban {% if item.sub_path is defined -%}

{%- if item.sub_path | default('') == 'action.d' -%}
  Action
{%- elif item.sub_path | default('') == 'filter.d' -%}
  Filter
{%- elif item.sub_path | default('') == 'jail.d' -%}
  Jail
{%- endif -%}
{%- else -%}
  Config
{%- endif -%}

, {{ item.name }}
#
# Managed By: Ansible
# Role: nfc_firewall
# 
# Do not edit this file directly as it will be automagically updated by ansible.
# to make changes update the ansible play that deploys this file.



{% for section_name, section_entries in item.sections.items() -%}


[{{ section_name }}]

{% for key, value in section_entries.items() -%}
{{ key }} = {{ value }}
{% endfor %}

{% endfor %}


{# {% if item.default is defined and item.default | default('') | length | int > 0 -%}
[DEFAULT]

{% for default in item.default -%}
{{ default.entry }} = {{ default.value }}
{% endfor -%}
{%- endif %}


{% for jail in item.jail -%}
{%- for entry, value in jail.items() -%}
{%- if entry == 'name' -%}
[{{ value }}]
{% endif %}
{% if entry != 'default' %}{{ entry }} = {{ value }}{% endif %}

{% endfor -%}
{% endfor %} #}
